<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhoujie.dao.NewsDao" >
  <resultMap id="BaseResultMap" type="com.zhoujie.model.News" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="newsId" property="newsid" jdbcType="INTEGER" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="publishDate" property="publishdate" jdbcType="TIMESTAMP" />
    <result column="author" property="author" jdbcType="VARCHAR" />
    <result column="typeId" property="typeid" jdbcType="INTEGER" />
    <result column="click" property="click" jdbcType="INTEGER" />
    <result column="isHead" property="ishead" jdbcType="TINYINT" />
    <result column="isImage" property="isimage" jdbcType="TINYINT" />
    <result column="imageName" property="imagename" jdbcType="VARCHAR" />
    <result column="isHot" property="ishot" jdbcType="TINYINT" />
    <result column="typeName" property="typeName" jdbcType="VARCHAR"/>
  </resultMap>
  
  <resultMap id="NewsType" type="com.zhoujie.model.NewsType" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="newsTypeId" property="newstypeid" jdbcType="INTEGER" />
    <result column="typeName" property="t_typename" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="ResultMapWithBLOBs" type="com.zhoujie.model.News" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="content" property="content" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    newsId, title, publishDate, author, typeId, click, isHead, isImage, imageName, isHot
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    content
  </sql>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    *
    from t_news , t_newstype
    where t_news.typeId = t_newstype.newsTypeId and newsId = #{newsid,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from t_news
    where newsId = #{newsid,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.zhoujie.model.News" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_news (newsId, title, publishDate, 
      author, typeId, click, 
      isHead, isImage, imageName, 
      isHot, content)
    values (#{newsid,jdbcType=INTEGER}, #{title,jdbcType=VARCHAR}, #{publishdate,jdbcType=TIMESTAMP}, 
      #{author,jdbcType=VARCHAR}, #{typeid,jdbcType=INTEGER}, #{click,jdbcType=INTEGER}, 
      #{ishead,jdbcType=TINYINT}, #{isimage,jdbcType=TINYINT}, #{imagename,jdbcType=VARCHAR}, 
      #{ishot,jdbcType=TINYINT}, #{content,jdbcType=LONGVARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.zhoujie.model.News" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_news
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="newsid != null" >
        newsId,
      </if>
      <if test="title != null" >
        title,
      </if>
      <if test="publishdate != null" >
        publishDate,
      </if>
      <if test="author != null" >
        author,
      </if>
      <if test="typeid != null" >
        typeId,
      </if>
      <if test="click != null" >
        click,
      </if>
      <if test="ishead != null" >
        isHead,
      </if>
      <if test="isimage != null" >
        isImage,
      </if>
      <if test="imagename != null" >
        imageName,
      </if>
      <if test="ishot != null" >
        isHot,
      </if>
      <if test="content != null" >
        content,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="newsid != null" >
        #{newsid,jdbcType=INTEGER},
      </if>
      <if test="title != null" >
        #{title,jdbcType=VARCHAR},
      </if>
      <if test="publishdate != null" >
        #{publishdate,jdbcType=TIMESTAMP},
      </if>
      <if test="author != null" >
        #{author,jdbcType=VARCHAR},
      </if>
      <if test="typeid != null" >
        #{typeid,jdbcType=INTEGER},
      </if>
      <if test="click != null" >
        #{click,jdbcType=INTEGER},
      </if>
      <if test="ishead != null" >
        #{ishead,jdbcType=TINYINT},
      </if>
      <if test="isimage != null" >
        #{isimage,jdbcType=TINYINT},
      </if>
      <if test="imagename != null" >
        #{imagename,jdbcType=VARCHAR},
      </if>
      <if test="ishot != null" >
        #{ishot,jdbcType=TINYINT},
      </if>
      <if test="content != null" >
        #{content,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.zhoujie.model.News" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_news
    <set >
      <if test="title != null" >
        title = #{title,jdbcType=VARCHAR},
      </if>
      <if test="publishdate != null" >
        publishDate = #{publishdate,jdbcType=TIMESTAMP},
      </if>
      <if test="author != null" >
        author = #{author,jdbcType=VARCHAR},
      </if>
      <if test="typeid != null" >
        typeId = #{typeid,jdbcType=INTEGER},
      </if>
      <if test="click != null" >
        click = #{click,jdbcType=INTEGER},
      </if>
      <if test="ishead != null" >
        isHead = #{ishead,jdbcType=TINYINT},
      </if>
      <if test="isimage != null" >
        isImage = #{isimage,jdbcType=TINYINT},
      </if>
      <if test="imagename != null" >
        imageName = #{imagename,jdbcType=VARCHAR},
      </if>
      <if test="ishot != null" >
        isHot = #{ishot,jdbcType=TINYINT},
      </if>
      <if test="content != null" >
        content = #{content,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where newsId = #{newsid,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.zhoujie.model.News" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_news
    set title = #{title,jdbcType=VARCHAR},
      publishDate = #{publishdate,jdbcType=TIMESTAMP},
      author = #{author,jdbcType=VARCHAR},
      typeId = #{typeid,jdbcType=INTEGER},
      click = #{click,jdbcType=INTEGER},
      isHead = #{ishead,jdbcType=TINYINT},
      isImage = #{isimage,jdbcType=TINYINT},
      imageName = #{imagename,jdbcType=VARCHAR},
      isHot = #{ishot,jdbcType=TINYINT},
      content = #{content,jdbcType=LONGVARCHAR}
    where newsId = #{newsid,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.zhoujie.model.News" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_news
    set title = #{title,jdbcType=VARCHAR},
      publishDate = #{publishdate,jdbcType=TIMESTAMP},
      author = #{author,jdbcType=VARCHAR},
      typeId = #{typeid,jdbcType=INTEGER},
      click = #{click,jdbcType=INTEGER},
      isHead = #{ishead,jdbcType=TINYINT},
      isImage = #{isimage,jdbcType=TINYINT},
      imageName = #{imagename,jdbcType=VARCHAR},
      isHot = #{ishot,jdbcType=TINYINT}
    where newsId = #{newsid,jdbcType=INTEGER}
  </update>
  
  <select id="selectByTypeId" parameterType="java.lang.Integer" resultType="com.zhoujie.model.News">
  	select 
  	<include refid="Base_Column_List" /> 
  	from t_news where typeId = #{typeid , jdbcType=INTEGER}
  </select>
  
  <select id="newsCounts" resultType="java.lang.Integer" >
  	select count(*) from t_news where 1=1
  	<if test="newstypeid != -1"> and typeId = #{newstypeid}</if>
  	<if test="title != null"> and title like CONCAT('%',#{title,jdbcType=VARCHAR},'%') </if>
  	<if test="aDate != null"> and TO_DAYS(publishDate)<![CDATA[ >= ]]>TO_DAYS(#{aDate})</if>
  	<if test="bDate != null"> and TO_DAYS(publishDate)<![CDATA[ <= ]]>TO_DAYS(#{bDate})</if>
  </select>
  
  <select id="newsList" resultType="com.zhoujie.model.News">
  	select 
  	<include refid="Base_Column_List" /> 
  	 from t_news t1,t_newsType t2 where t1.typeId=t2.newsTypeId 
  	 <if test="newstypeid !=-1">  and t1.typeId=newstypeid </if>
  	 <if test="title != null">  and t1.title like CONCAT('%',#{title},'%') </if>
  	 <if test="bDate != null and bDate != ''">  and TO_DAYS(t1.publishDate)<![CDATA[ >= ]]>TO_DAYS('${bDate}')</if>
  	 <if test="aDate != null and aDate != ''">  and TO_DAYS(t1.publishDate)<![CDATA[ <= ]]>TO_DAYS('${aDate}')</if>
  	 order by t1.publishDate desc 
  	 <if test="pageStart !=null and pageSize != null"> limit ${pageStart} , ${pageSize} </if>
  </select>
  
  <select id="newestNewsList" resultType="com.zhoujie.model.News">
  	select * from t_news order by publishDate desc limit 0,8 
  </select>
  
  <select id="hotNewsList" resultType="com.zhoujie.model.News">
  	select * from t_news order by click desc limit 0,8 
  </select>
  
  <select id="imageNewsList" resultType="com.zhoujie.model.News">
  	select * from t_news where isHead=1 order by publishDate desc limit 0,5 
  </select>
  
  <select id="headNewsList" resultType="com.zhoujie.model.News">
  	select * from t_news where isHead=1 order by publishDate desc limit 0,1 
  </select>
  
  <select id="hotSpotNewsList" resultType="com.zhoujie.model.News">
  	select * from t_news where isHot=1 order by publishDate desc limit 0,8 
  </select>
  
  <select id="oneSubList" resultType="com.zhoujie.model.News" parameterType="java.lang.Integer">
  	select 
  	* 
  	from t_news t1,t_newsType t2 
  	where t1.typeId = t2.newsTypeId 
  	and t1.typeId = ${newstypeid} 
  	order by t1.publishDate desc 
  	limit 0,8
  </select>
  
  <update id="newsClickCount" parameterType="java.lang.Integer" >
  	update t_news set click=click+1 where newsId = #{newsid,jdbcType=INTEGER}
  </update>
  
  <select id="getDownPageId" resultType="com.zhoujie.model.News" parameterType="java.lang.Integer">
  	SELECT * FROM t_news WHERE newsId<![CDATA[ < ]]>#{newsid,jdbcType=INTEGER} ORDER BY newsId DESC LIMIT 1;
  </select>
  
  <select id="getUpPageId" resultType="com.zhoujie.model.News" parameterType="java.lang.Integer">
  	SELECT * FROM t_news WHERE newsId<![CDATA[ > ]]>#{newsid,jdbcType=INTEGER} ORDER BY newsId ASC LIMIT 1;
  </select>
</mapper>